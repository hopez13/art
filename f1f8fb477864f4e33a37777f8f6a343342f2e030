{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "7e915ecb_a0dc57bc",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 36,
      "author": {
        "id": 1550939
      },
      "writtenOn": "2024-06-28T19:35:43Z",
      "side": 1,
      "message": "Is there any way to test that we\u0027ve got `kRuntimeQuickCodeISA` in all the right places, and we did not by accident put `kRuntimeISA` somewhere (and this won\u0027t happen in the future)?",
      "range": {
        "startLine": 35,
        "startChar": 0,
        "endLine": 36,
        "endChar": 29
      },
      "revId": "f1f8fb477864f4e33a37777f8f6a343342f2e030",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "355b8b8f_789809af",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 36,
      "author": {
        "id": 1989777
      },
      "writtenOn": "2024-07-25T12:25:41Z",
      "side": 1,
      "message": "Unfortunately I don\u0027t think there is a way to automate this kind of testing. The problem is that the only difference between the two is in the semantics of native vs quick which is not currently well defined in ART. This makes the process of testing rather manual to perform.\n\nAs `kRuntimeISA \u003d\u003d\u003d kRuntimeQuickCodeISA` when not on the simulator this change will only make a difference to simulator builds and so that can be used to test a lot of this code in an ad-hoc way. Of course if some code is not exercised by the simulator then it won\u0027t be tested until the simulator is enabled to run that code.\n\nIn addition to this testing on the simulator, I have also searched through all uses of kRuntimeISA and applied the change that best suited the semantics of how it was being used. Once I rebase this patch I will do the same search and look through the diff of uses of kRuntimeISA to check that no new or modified uses were missed.",
      "parentUuid": "7e915ecb_a0dc57bc",
      "range": {
        "startLine": 35,
        "startChar": 0,
        "endLine": 36,
        "endChar": 29
      },
      "revId": "f1f8fb477864f4e33a37777f8f6a343342f2e030",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6b4fa424_5b9e6f95",
        "filename": "libartbase/arch/instruction_set.h",
        "patchSetId": 5
      },
      "lineNbr": 58,
      "author": {
        "id": 1550939
      },
      "writtenOn": "2024-06-28T19:35:43Z",
      "side": 1,
      "message": "Can you expand the comment to explicitly mention the case when this differs from runtime ISA, and the reason why it differs?\n\nWhat I\u0027m concerned about is that we may have a clear understanding now of why simulator uses arm64 entrypoints when running on x86 host, but for someone who sees this for the first time with no idea about the simulator it may be not so clear.\n\nI think we should have at least one detailed comment about this cross-arch simulator behavior somewhere in the ART source code. (do we already?) This may not be the best place for it, so feel free to it where you see fit.",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 58,
        "endChar": 71
      },
      "fixSuggestions": [
        {
          "fixId": "96fad3b9_98fc1663",
          "description": "prompt_to_edit API",
          "replacements": [
            {
              "path": "libartbase/arch/instruction_set.h",
              "range": {
                "startLine": 58,
                "startChar": 0,
                "endLine": 59,
                "endChar": 0
              },
              "replacement": "// will be used for the quick context, quick stack frame and quick ABI. This may differ from\n// kRuntimeISA in the case of a JIT-on-x86-64 runtime, where the runtime is x86-64 but the JIT\n// generates ARM code.\n"
            }
          ]
        }
      ],
      "revId": "f1f8fb477864f4e33a37777f8f6a343342f2e030",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "60011b6b_6cf49457",
        "filename": "libartbase/arch/instruction_set.h",
        "patchSetId": 5
      },
      "lineNbr": 58,
      "author": {
        "id": 1989777
      },
      "writtenOn": "2024-07-25T12:25:41Z",
      "side": 1,
      "message": "Thanks for the suggestion! This should also become clearer in the code as part of https://android-review.googlesource.com/c/platform/art/+/2680028/5/libartbase/arch/instruction_set.h#59",
      "parentUuid": "6b4fa424_5b9e6f95",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 58,
        "endChar": 71
      },
      "revId": "f1f8fb477864f4e33a37777f8f6a343342f2e030",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}