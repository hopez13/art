{
  "comments": [
    {
      "key": {
        "uuid": "a4b85952_24a9ad40",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 18,
      "author": {
        "id": 1550939
      },
      "writtenOn": "2020-06-11T11:27:50Z",
      "side": 1,
      "message": "This is actually incorrect, there is no /system/apex, and apex is not necessarily com.android.art. The correct list is:\n\n- $(PRODUCT_OUT)/apex/\u003csome-apex-name\u003e/javalib\n- $(PRODUCT_OUT)/system/framework\n- $(PRODUCT_OUT)/system_ext/framework",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 18,
        "endChar": 39
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3a8e8d37_772b2450",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 18,
      "author": {
        "id": 1591840
      },
      "writtenOn": "2020-06-12T07:36:32Z",
      "side": 1,
      "message": "ok, remove my incorrect comment",
      "parentUuid": "a4b85952_24a9ad40",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 18,
        "endChar": 39
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f44be397_adf25733",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 21,
      "author": {
        "id": 1550939
      },
      "writtenOn": "2020-06-11T11:27:50Z",
      "side": 1,
      "message": "Nice fix, thank you.",
      "range": {
        "startLine": 20,
        "startChar": 0,
        "endLine": 21,
        "endChar": 55
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "03ec4b8b_a0aff7c9",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 21,
      "author": {
        "id": 1591840
      },
      "writtenOn": "2020-06-12T07:36:32Z",
      "side": 1,
      "message": "thank you.",
      "parentUuid": "f44be397_adf25733",
      "range": {
        "startLine": 20,
        "startChar": 0,
        "endLine": 21,
        "endChar": 55
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "042869c8_72a66c51",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 26,
      "author": {
        "id": 1550939
      },
      "writtenOn": "2020-06-11T11:27:50Z",
      "side": 1,
      "message": "Please move to a separate commit.",
      "range": {
        "startLine": 23,
        "startChar": 0,
        "endLine": 26,
        "endChar": 52
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "19ab3966_fa71003e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 26,
      "author": {
        "id": 1591840
      },
      "writtenOn": "2020-06-12T07:36:32Z",
      "side": 1,
      "message": "ok, it has been removed from patch3",
      "parentUuid": "042869c8_72a66c51",
      "range": {
        "startLine": 23,
        "startChar": 0,
        "endLine": 26,
        "endChar": 52
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4a2c8673_2402c8ec",
        "filename": "tools/generate-boot-image-profile.sh",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1550939
      },
      "writtenOn": "2020-06-11T11:27:50Z",
      "side": 1,
      "message": "Adding dump-only mode is useful, but let\u0027s do this in a separate CL. Also, please keep one \"Usage\", but describe all possible invocations mode in it.",
      "range": {
        "startLine": 24,
        "startChar": 120,
        "endLine": 29,
        "endChar": 0
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "72dff011_c54ac3e4",
        "filename": "tools/generate-boot-image-profile.sh",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1591840
      },
      "writtenOn": "2020-06-12T07:36:32Z",
      "side": 1,
      "message": "removed.",
      "parentUuid": "4a2c8673_2402c8ec",
      "range": {
        "startLine": 24,
        "startChar": 120,
        "endLine": 29,
        "endChar": 0
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0b368d3c_e95f4c37",
        "filename": "tools/generate-boot-image-profile.sh",
        "patchSetId": 2
      },
      "lineNbr": 77,
      "author": {
        "id": 1550939
      },
      "writtenOn": "2020-06-11T11:27:50Z",
      "side": 1,
      "message": "As discussed, this approach won\u0027t work for AOSP where the structure of boot jar list has changed. (It also is incorrect in that paths $product_out/system/apex do not exist.) I suggest the following code instead of the highlighted block (I checked in both AOSP and R that it constructs the list of jars correctly):\n\n  # b/139391334: the stem of framework-minus-apex is framework                                                                                                                                                                                   \n  real_jar_name() {                                                                                                                                                                                                                              \n    if [[ \"$1\" \u003d\u003d \"framework-minus-apex\" ]]; then                                                                                                                                                                                                \n      echo \"framework\"                                                                                                                                                                                                                           \n    else                                                                                                                                                                                                                                         \n      echo \"$1\"                                                                                                                                                                                                                                  \n    fi                                                                                                                                                                                                                                           \n  }                                                                                                                                                                                                                                              \n                                                                                                                                                                                                                                               \n  # Boot jars have hidden API access flags which do not pass dex file                                                                                                                                                                            \n  # verification. Skip it.                                                                                                                                                                                                                       \n  jar_args\u003d()                                                                                                                                                                                                                                    \n  boot_jars\u003d$(\"$ANDROID_BUILD_TOP\"/art/tools/bootjars.sh --target)                                                                                                                                                                               \n  product_out\u003d$ANDROID_BUILD_TOP/$(get_build_var PRODUCT_OUT)                                                                                                                                                                                    \n  for pair in $boot_jars; do                                                                                                                                                                                                                     \n    words\u003d( $(echo $pair | tr \u0027:\u0027 \u0027 \u0027) )                                                                                                                                                                                                         \n    if [[ ${#words[@]} -eq 2 ]]; then                                                                                                                                                                                                            \n      # format in Android \u003e R: \u003capex\u003e:\u003cjar\u003e                                                                                                                                                                                                      \n      apex\u003d\"${words[0]}\"                                                                                                                                                                                                                         \n      name\u003d\"$(real_jar_name ${words[1]})\"                                                                                                                                                                                                        \n      case \"$apex\" in                                                                                                                                                                                                                            \n          platform*)   subdir\u003dsystem/framework ;;                                                                                                                                                                                                \n          system_ext*) subdir\u003dsystem_ext/framework ;;                                                                                                                                                                                            \n          *)           subdir\u003dapex/$apex/javalib ;;                                                                                                                                                                                              \n      esac                                                                                                                                                                                                                                       \n      filename\u003d\"$product_out/$subdir/$name.jar\"                                                                                                                                                                                                  \n    else                                                                                                                                                                                                                                         \n      # format in Android \u003c\u003d R: \u003cjar\u003e, have to infer location with `find`                                                                                                                                                                        \n      name\u003d\"$(real_jar_name ${words[0]})\"                                                                                                                                                                                                        \n      filename\u003d\"$(find $product_out -name $name.jar 2\u003e/dev/null)\"                                                                                                                                                                                \n      if [[ $(echo \"$filename\" | wc -w ) -ne 1 ]]; then                                                                                                                                                                                          \n        echo \"expected to find $name.jar, got \u0027$filename\u0027\"                                                                                                                                                                                       \n        exit 1                                                                                                                                                                                                                                   \n      fi                                                                                                                                                                                                                                         \n    fi                                                                                                                                                                                                                                           \n    jar_args+\u003d(\"--apk\u003d$filename\")                                                                                                                                                                                                                \n    jar_args+\u003d(\"--dex-location\u003d$filename\")                                                                                                                                                                                                       \n  done                                                                                                                                                                                                                                           \n  profman_args+\u003d(\"${jar_args[@]}\")",
      "range": {
        "startLine": 52,
        "startChar": 0,
        "endLine": 77,
        "endChar": 32
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "daf08ef7_b3c7a4a3",
        "filename": "tools/generate-boot-image-profile.sh",
        "patchSetId": 2
      },
      "lineNbr": 77,
      "author": {
        "id": 1591840
      },
      "writtenOn": "2020-06-12T07:36:32Z",
      "side": 1,
      "message": "done\nthis code works fine with AndroidR.\nupdate this version in patch3.",
      "parentUuid": "0b368d3c_e95f4c37",
      "range": {
        "startLine": 52,
        "startChar": 0,
        "endLine": 77,
        "endChar": 32
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "94c82700_2eba3c6d",
        "filename": "tools/generate-boot-image-profile.sh",
        "patchSetId": 2
      },
      "lineNbr": 82,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2020-06-12T02:13:13Z",
      "side": 1,
      "message": "This does not work anymore. The boot image profile generation has change. I will upload the AOSP patches for reference.",
      "range": {
        "startLine": 81,
        "startChar": 1,
        "endLine": 82,
        "endChar": 124
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bfcdc6c1_92b3a6d7",
        "filename": "tools/generate-boot-image-profile.sh",
        "patchSetId": 2
      },
      "lineNbr": 82,
      "author": {
        "id": 1550939
      },
      "writtenOn": "2020-06-12T09:22:57Z",
      "side": 1,
      "message": "Calin, can we merge this CL (which fixes paths to boot jars for both R and AOSP) and rebase your patches on top?",
      "parentUuid": "94c82700_2eba3c6d",
      "range": {
        "startLine": 81,
        "startChar": 1,
        "endLine": 82,
        "endChar": 124
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9ac2b986_e6a9e7bf",
        "filename": "tools/generate-boot-image-profile.sh",
        "patchSetId": 2
      },
      "lineNbr": 86,
      "author": {
        "id": 1550939
      },
      "writtenOn": "2020-06-11T11:27:50Z",
      "side": 1,
      "message": "Please move this useful rework to a follow-up patch.",
      "range": {
        "startLine": 80,
        "startChar": 0,
        "endLine": 86,
        "endChar": 2
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aa9a89cd_943333a8",
        "filename": "tools/generate-boot-image-profile.sh",
        "patchSetId": 2
      },
      "lineNbr": 86,
      "author": {
        "id": 1591840
      },
      "writtenOn": "2020-06-12T07:36:32Z",
      "side": 1,
      "message": "okï¼Œ after Calin Juravle updating the profman command line.",
      "parentUuid": "9ac2b986_e6a9e7bf",
      "range": {
        "startLine": 80,
        "startChar": 0,
        "endLine": 86,
        "endChar": 2
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fa91bc1a_ccb2ef16",
        "filename": "tools/generate-boot-image-profile.sh",
        "patchSetId": 2
      },
      "lineNbr": 86,
      "author": {
        "id": 1550939
      },
      "writtenOn": "2020-06-12T09:16:48Z",
      "side": 1,
      "message": "Ok, thanks.",
      "parentUuid": "aa9a89cd_943333a8",
      "range": {
        "startLine": 80,
        "startChar": 0,
        "endLine": 86,
        "endChar": 2
      },
      "revId": "f7c6ec812d1c9eadf91c0734a0a3534954cc7593",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}